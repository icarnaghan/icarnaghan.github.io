<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>AWS CodePipeline for Static Websites | Ian Carnaghan</title>
<meta name=keywords content="aws"><meta name=description content="AWS offers an immense array of features for deploying and managing complex sites. There are however a lot of use cases where you want to quickly setup an easy to use pipeline for deploying static websites (without a build process). I am going to cover how to get started using AWS to setup a basic no-frills web server using an easy-to-use deployment setup via AWS code repository and deployment services."><meta name=author content="icarnaghan"><link rel=canonical href=https://www.carnaghan.com/aws-codepipeline-for-static-websites/><meta name=google-site-verification content="G-7Q7KDW64SY"><link crossorigin=anonymous href=/assets/css/stylesheet.f49d66caae9ea0fd43f21f29e71a8d3e284517ed770f2aa86fa012953ad3c9ef.css integrity="sha256-9J1myq6eoP1D8h8p5xqNPihFF+13Dyqob6ASlTrTye8=" rel="preload stylesheet" as=style><link rel=icon href=https://www.carnaghan.com/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://www.carnaghan.com/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://www.carnaghan.com/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://www.carnaghan.com/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://www.carnaghan.com/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://www.carnaghan.com/aws-codepipeline-for-static-websites/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://www.carnaghan.com/aws-codepipeline-for-static-websites/"><meta property="og:site_name" content="Ian Carnaghan"><meta property="og:title" content="AWS CodePipeline for Static Websites"><meta property="og:description" content="AWS offers an immense array of features for deploying and managing complex sites. There are however a lot of use cases where you want to quickly setup an easy to use pipeline for deploying static websites (without a build process). I am going to cover how to get started using AWS to setup a basic no-frills web server using an easy-to-use deployment setup via AWS code repository and deployment services."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-01-28T00:00:00+00:00"><meta property="article:modified_time" content="2019-01-28T00:00:00+00:00"><meta property="article:tag" content="Aws"><meta property="og:image" content="https://www.carnaghan.com/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.carnaghan.com/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="AWS CodePipeline for Static Websites"><meta name=twitter:description content="AWS offers an immense array of features for deploying and managing complex sites. There are however a lot of use cases where you want to quickly setup an easy to use pipeline for deploying static websites (without a build process). I am going to cover how to get started using AWS to setup a basic no-frills web server using an easy-to-use deployment setup via AWS code repository and deployment services."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://www.carnaghan.com/posts/"},{"@type":"ListItem","position":2,"name":"AWS CodePipeline for Static Websites","item":"https://www.carnaghan.com/aws-codepipeline-for-static-websites/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"AWS CodePipeline for Static Websites","name":"AWS CodePipeline for Static Websites","description":"AWS offers an immense array of features for deploying and managing complex sites. There are however a lot of use cases where you want to quickly setup an easy to use pipeline for deploying static websites (without a build process). I am going to cover how to get started using AWS to setup a basic no-frills web server using an easy-to-use deployment setup via AWS code repository and deployment services.\n","keywords":["aws"],"articleBody":"AWS offers an immense array of features for deploying and managing complex sites. There are however a lot of use cases where you want to quickly setup an easy to use pipeline for deploying static websites (without a build process). I am going to cover how to get started using AWS to setup a basic no-frills web server using an easy-to-use deployment setup via AWS code repository and deployment services.\nBefore we get started, there are a couple of pre-requisites needed in order to follow along:\nAWS account with EC2, S3, CodePipeline, CodeDeploy, and CodeCommit permissions. If you don’t have an AWS account, you can sign up for the free tier for one year. Git client: For Mac, I recommend Homebrew (brew install git). On the PC, you can use Git SCM. There are a number of steps we need to complete in order to setup our code pipeline with a new web server. These steps include creating a new security group, setting up a key pair, which we will use to access our AWS EC2 instance, provisioning a new EC2 instance, and setting up our code pipeline for Continuous Integration/Continuous Delivery (CI/CD).\nRoles and Permissions When setting up a CodeDeploy (later in this article), we will need to use service roles for to provide needed permissions for both the CodeDeploy service (service role) as well as for our EC2 instance that we are deploying code to (instance role). Let’s go ahead and set these up. There are more detailed directions available within AWS documentation and I’ve provided links should you want to learn more.\nCodeDeploy Service Role Using the AWS console, browse to IAM Management and select Roles - Create Role. Next select CodeDeploy and under Use Case choose ‘CodeDeploy’. Click ‘Next: Permissions’ leaving defaults and ‘Next: Tags’ leaving blank. Click ‘Next: Review’. Here you can provide a name for your service role. I am using the name carnaghan-codedeploy. Keep a note of the name you choose as you will need this later.\nFor more information, see: Create a Service Role for AWS CodeDeploy.\nIAM EC2 Instance Role In order for our EC2 server to work with CodeDeploy, we need to create an IAM instance role. In IAM Management select ‘Create Role’. Under service select ‘EC2’ and then click ‘Next: Permissions’. Under ‘Filter Policies’ type ‘S3’ and then select ‘AmazonS3ReadOnlyAccess’. Select ‘Next: Tags’ and then ‘Next: Review’. Provide a name for your role, I used carnaghan-dev. Keep a note of whatever name you choose for later.\nNote: for simplicity I chose AmazonS3ReadOnlyAccess’, however for better security you can create your own policy and choose only those parts of S3 needed for CodeDeploy.\nFor more information see: CodeDeploy: Create an IAM Instance Profile for Your Amazon EC2 Instances.\nCreating our EC2 Security Group and Key Pair Before we can setup a new EC2 instance which will serve as our web server, we need to create a security group. The security group will determine ingoing and outgoing traffic. Security groups in AWS are simply firewalls at the server level. They will enable us to allow traffic from various sources access to our server. To keep things simple, I am going to enable all incoming traffic for HTTP and SSH connections, which we will need for our setup. Ideally, SSH traffic should be restricted to your own set of IP addresses which you will access the EC2 instance from for security purposes. Within the AWS Console, select EC2 under the Compute group. Under Network and Security select ‘Security Groups’. Select ‘Create Security Group’ and provide a name. In my example, I am using carnaghan-dev. Next we will configure the inbound traffic our security group will permit. Under the Inbound tab, select Add Rule. You should add two rules (one for SSH and one for HTTP) with IP address 0.0.0.0, ::/0 for each (which allows all incoming traffic for that protocol by default). Click Create to save your new security group. We will now be able to use this when provisioning our new EC2 instance.\nNext we need to create a key pair. This is a set of credentials we will use to access our EC2 instance once it is setup.Under the same Network and Security section we accessed Security Groups, select Key Pairs. Click on Create Key Pair and provide a name. In my example I am using the name carnaghan-dev. Once created, you will receive a download file with a .pem extension. This is your private RSA key, which will be used later to SSH into our server. For now store this in a safe place.\nCreating our EC2 Instance Next we are going to provision our web server. From the AWS console, select Services -\u003e Compute -\u003e EC2. Next click the Launch Instance button. We are going to choose Amazon Linux 2 AMI (HVM), SSD Volume Type, which should be the very first entry under Amazon Machine Images (AMIs).\nClick Select. On the next screen for instance type, choose t2.micro (free tier eligible). Click Next - Configure Instance Details. Scroll down to Advanced and click to expand. Under User Data, paste the following code:\n#!/bin/bash sudo yum update -y sudo yum install -y httpd sudo service httpd start sudo chkconfig httpd on sudo yum install ruby -y sudo yum install wget -y cd /home/ec2-user wget https://aws-codedeploy-us-east-1.s3.amazonaws.com/latest/install chmod +x ./install sudo ./install auto AWS provides User Data to allow us to pass one time commands to our server once it is provisioned, or booted up for the first time. The first part of the above code runs updates on the operating system, followed by installing and running our Apache web server. The second set of commands provisions our CodeDeploy agent, which we will be using later on for our Continuous Deployment. Click Next - Add Storage and leave all defaults as is. AWS automatically provisions an 8Gb Elastic Block Storage (EBS) volume for our instance, which will act as our hard drive or storage. Click Next - Add Tags and add a Name tag for your instance. In my example I am using Name: carnaghan-dev as below.\nClick Next - Configure Security Group. Here you will choose the security group you setup above. Be sure to complete this step correctly or you may not be able to access your instance.\nAfter you have chosen your security group, click Review and Launch and on the following screen select Launch. You will be prompted to create or choose a key pair to access your server. Select the key pair you created above and then click launch instance.\nAt this stage you have completed all steps to launch your EC2 instance. It will take several minutes to provision and run our user data commands specified above. To view the status of your EC2 instance select View Instances on the confirmation page. After several minutes have passed, the status of your instance should change from Initializing to Running. At this time, copy the public DNS address, it should look something like ec2-99-99-999-99.compute-1.amazonaws.com. Paste this address into your web browser. If everything is running as expected with your new Apache webserver, you should see the test page below.\nIf you don’t see the test page, give your instance another few minutes to fully initialize.\nSetting up Code Commit There are two main ways you can manage CodeCommit repositories:\nInstall the AWS Command Line Interface (CLI) and provide CodeCommit to your AWS account Create a public SSH Key which you can then upload to your repository (in a similar way you would manage a Github repository) For this setup, I am going to recommend using the CLI as it provides a lot more options out of the box and the more you work with AWS the more you will come to use this tool. In order to install the CLI, follow this guide: Installing the AWS CLI. If you prefer to use a public key, see Setup for SSH Users Not Using the AWS CLI.\nNext we will setup our code repository, which will enable us to update our website. Using the AWS console, head over to CodeCommit and create a new repository.\nI am again using the name carnaghan-dev for consistency. Once you have setup your repository you will need to clone a local copy. If you don’t have a git client, please see the links I provided at the beginning of this article (Homebrew for Mac, GitSCM for PC). Once your client is setup and you have installed the AWS CLI or uploaded your public key, you should be able to clone your repository. In your command line / terminal, run the following command replacing ‘your-repo-name’:\ngit clone https://git-codecommit.us-east-1.amazonaws.com/v1/repos/your-repo-name Once cloned you will be able to begin adding new files. We are going to create two different files needed for our code deployment, a test index file, and a file called appspec.yml.\nindex.html\nappspec.yml\nOnce you have added these files to your empty repository directory we will need to commit them.\ngit add -A git commit -m \"Initial commit\" git push Next, head back over to your repository in the AWS console to confirm your files have been uploaded.\nYou have completed the first steps in our code pipeline by initializing your CodeCommit repository and adding our appspec.yml and index.html files.\nWhat is appspec.yml? You might be wondering what appspec.yml is needed for? This is a basic yaml file that defines where our code will be deployed. Since this is going to be a simple static file deployment, we just need to specify our server path, which by default with Apache is /var/www/html/. AWS CodeDeploy will use this file once deploying the latest updates to our site. For a better overview of appspec.yml, take a look at AWS CodeDeploy AppSpec File Reference.\nCodeDeploy Now that we have our code repository setup with our basic file structure, the next step is to setup our CodeDeploy application. To do this, navigate to CodeDeploy within the AWS console and select ‘Create Application’. Fill out the form including your application name and choose EC2/On-Premesis.\nNext, you will need to select ‘Create Deployment Group’ and provide the following information:\nDeployment group name (I chose carnaghan-dev-group) Service Role (Choose the service role you created earlier) Deployment Type (In-place) Environment configuration (EC2 Instance / Key: Name, Value: your-ec2-instance) Deployment Settings (CodeDeployDefault.AllAtOnce) Load Balancer (Uncheck this option) CodePipeline Now that we have defined our source (CodeCommit) and our target (CodeDeploy), let’s tie it all together using CodePipeline. Note that usually in larger applications that require build processes we would also use CodeBuild. For the sake of simplicity and since we are dealing with a small static website, we only need CodeCommit and CodeDeploy for our pipeline. From the AWS console, select CodePipeline and then select ‘Create Pipeline’. You will need to provide the following information:\nPipeline Name (I am using the name carnaghan-pipeline) Choose ‘New Service Role’ and leave the new default role name (Note this is different from the CodeDeploy service role you created at the beginning of this article). Make sure ‘Allow AWS CodePipeline to create a service role so it can be used with this new pipeline’ is checked Choose Default Location - AWS will create an S3 Bucket for your revisions to deploy Select Next and then choose CodeCommit for Source Provider, choose your repository and select ‘Master’ branch Leave Amazon CloudWatch Events selected and select ‘Next’ Select Skip Build Stage Choose AWS CodeDeploy for Deployment Provider and select your application and deployment group Review everything and then select ‘Create Pipeline’ Once you have completed these steps you should be returned to the main CodePipeline screen and a new deployment will run. If everything was setup correctly you should see a screen similar to the one below.\nTo verify everything worked as planned, visit your EC2 server homepage. If you forgot the URL, visit EC2 in the AWS Console, click ‘Running Instances’ and select your instance to review the Public DNS address. You should now see a new HTML page displaying:\nTesting The Pipeline Congratulations, you have setup a basic CodePipeline for your webpage. Let’s try one last thing. Update your HTML page by adding the sentence ‘AWS CodePipeline complete’.\nAdd this file to Git and push your changes.\ngit add -A git commit -m \"Modifying index.html\" git push If you visit the CodePipeline page you should see it momentarily running a new deployment. Your final changes will appear once deployment has been completed.\nFor more information on CodePipeline and another tutorial on setting up a basic pipeline, visit Create a Simple Pipeline (AWS CodeCommit Repository). Also be sure to read the documentation on CodeCommit, CodeDeploy, and CodePipeline. If you have a more complex application that requires build processes, the AWS CodeBuild Documentation is a great place to start. Hopefully you found this helpful.\n","wordCount":"2135","inLanguage":"en","image":"https://www.carnaghan.com/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2019-01-28T00:00:00Z","dateModified":"2019-01-28T00:00:00Z","author":{"@type":"Person","name":"icarnaghan"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.carnaghan.com/aws-codepipeline-for-static-websites/"},"publisher":{"@type":"Organization","name":"Ian Carnaghan","logo":{"@type":"ImageObject","url":"https://www.carnaghan.com/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.carnaghan.com/ accesskey=h title="Ian Carnaghan (Alt + H)"><img src=https://www.carnaghan.com/apple-touch-icon.png alt aria-label=logo height=35>Ian Carnaghan</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://www.carnaghan.com/about-me/ title="About Me"><span>About Me</span></a></li><li><a href=https://www.carnaghan.com/categories/coding/ title=Coding><span>Coding</span></a></li><li><a href=https://www.carnaghan.com/bitesize-javascript/ title="Bitesize JavaScript"><span>Bitesize JavaScript</span></a></li><li><a href=https://www.carnaghan.com/categories/data-analytics/ title="Data Analytics"><span>Data Analytics</span></a></li><li><a href=https://www.carnaghan.com/categories/cybersecurity/ title=Cybersecurity><span>Cybersecurity</span></a></li><li><a href=https://www.carnaghan.com/categories/ux-design/ title="UX and Design"><span>UX and Design</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://www.carnaghan.com/>Home</a>&nbsp;»&nbsp;<a href=https://www.carnaghan.com/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">AWS CodePipeline for Static Websites</h1><div class=post-meta><span title='2019-01-28 00:00:00 +0000 UTC'>January 28, 2019</span>&nbsp;·&nbsp;11 min&nbsp;·&nbsp;2135 words&nbsp;·&nbsp;icarnaghan&nbsp;|&nbsp;<a href=https://github.com/%3cpath_to_repo%3e/content/posts/aws-codepipeline-for-static-websites/index.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><p>AWS offers an immense array of features for deploying and managing complex sites. There are however a lot of use cases where you want to quickly setup an easy to use pipeline for deploying static websites (without a build process). I am going to cover how to get started using AWS to setup a basic no-frills web server using an easy-to-use deployment setup via AWS code repository and deployment services.</p><p><img loading=lazy src=/aws-codepipeline-for-static-websites/images/CodePipeline.png></p><p>Before we get started, there are a couple of pre-requisites needed in order to follow along:</p><ol><li>AWS account with EC2,  S3, CodePipeline, CodeDeploy, and CodeCommit permissions. If you don&rsquo;t have an AWS account, you can sign up for the free tier for one year.</li><li>Git client: For Mac, I recommend Homebrew (brew install git). On the PC, you can use Git SCM.</li></ol><p>There are a number of steps we need to complete in order to setup our code pipeline with a new web server. These steps include creating a new security group, setting up a key pair, which we will use to access our AWS EC2 instance, provisioning a new EC2 instance, and setting up our code pipeline for Continuous Integration/Continuous Delivery (CI/CD).</p><h2 id=roles-and-permissions>Roles and Permissions<a hidden class=anchor aria-hidden=true href=#roles-and-permissions>#</a></h2><p>When setting up a CodeDeploy (later in this article), we will need to use service roles for to provide needed permissions for both the CodeDeploy service (service role) as well as for our EC2 instance that we are deploying code to (instance role). Let&rsquo;s go ahead and set these up. There are more detailed directions available within AWS documentation and I&rsquo;ve provided links should you want to learn more.</p><h3 id=codedeploy-service-role>CodeDeploy Service Role<a hidden class=anchor aria-hidden=true href=#codedeploy-service-role>#</a></h3><ul><li>Using the AWS console, browse to IAM Management and select Roles - Create Role.</li><li>Next select CodeDeploy and under Use Case choose &lsquo;CodeDeploy&rsquo;.</li><li>Click &lsquo;Next: Permissions&rsquo; leaving defaults and &lsquo;Next: Tags&rsquo; leaving blank.</li><li>Click &lsquo;Next: Review&rsquo;.</li></ul><p><img alt="CodeDeploy Service Role" loading=lazy src=/aws-codepipeline-for-static-websites/images/codedeploy-sr.jpeg></p><p>Here you can provide a name for your service role. I am using the name <strong>carnaghan-codedeploy</strong>. Keep a note of the name you choose as you will need this later.</p><blockquote><p>For more information, see: Create a Service Role for AWS CodeDeploy.</p></blockquote><h3 id=iam-ec2-instance-role>IAM EC2 Instance Role<a hidden class=anchor aria-hidden=true href=#iam-ec2-instance-role>#</a></h3><p>In order for our EC2 server to work with CodeDeploy, we need to create an IAM instance role. In IAM Management select &lsquo;Create Role&rsquo;. Under service select &lsquo;EC2&rsquo; and then click &lsquo;Next: Permissions&rsquo;. Under &lsquo;Filter Policies&rsquo; type &lsquo;S3&rsquo; and then select &lsquo;AmazonS3ReadOnlyAccess&rsquo;. Select &lsquo;Next: Tags&rsquo; and then &lsquo;Next: Review&rsquo;. Provide a name for your role, I used <strong>carnaghan-dev</strong>. Keep a note of whatever name you choose for later.</p><p>Note: for simplicity I chose AmazonS3ReadOnlyAccess&rsquo;, however for better security you can create your own policy and choose only those parts of S3 needed for CodeDeploy.</p><blockquote><p>For more information see: CodeDeploy: Create an IAM Instance Profile for Your Amazon EC2 Instances.</p></blockquote><h2 id=creating-our-ec2-security-group-and-key-pair>Creating our EC2 Security Group and Key Pair<a hidden class=anchor aria-hidden=true href=#creating-our-ec2-security-group-and-key-pair>#</a></h2><p>Before we can setup a new EC2 instance which will serve as our web server, we need to create a security group. The security group will determine ingoing and outgoing traffic. Security groups in AWS are simply firewalls at the server level. They will enable us to allow traffic from various sources access to our server. To keep things simple, I am going to enable all incoming traffic for HTTP and SSH connections, which we will need for our setup. Ideally, SSH traffic should be restricted to your own set of IP addresses which you will access the EC2 instance from for security purposes. Within the AWS Console, select EC2 under the Compute group. Under Network and Security select &lsquo;Security Groups&rsquo;. Select &lsquo;Create Security Group&rsquo; and provide a name. In my example, I am using <strong>carnaghan-dev</strong>. Next we will configure the inbound traffic our security group will permit. Under the Inbound tab, select Add Rule. You should add two rules (one for SSH and one for HTTP) with IP address 0.0.0.0, ::/0 for each (which allows all incoming traffic for that protocol by default). Click Create to save your new security group. We will now be able to use this when provisioning our new EC2 instance.</p><p><img loading=lazy src=/aws-codepipeline-for-static-websites/images/sg.jpeg></p><p>Next we need to create a key pair. This is a set of credentials we will use to access our EC2 instance once it is setup.Under the same Network and Security section we accessed Security Groups, select Key Pairs. Click on Create Key Pair and provide a name. In my example I am using the name <strong>carnaghan-dev</strong>. Once created, you will receive a download file with a .pem extension. This is your private RSA key, which will be used later to SSH into our server. For now store this in a safe place.</p><h2 id=creating-our-ec2-instance>Creating our EC2 Instance<a hidden class=anchor aria-hidden=true href=#creating-our-ec2-instance>#</a></h2><p>Next we are going to provision our web server. From the AWS console, select Services -> Compute -> EC2. Next click the Launch Instance button. We are going to choose <strong>Amazon Linux 2 AMI (HVM), SSD Volume Type</strong>, which should be the very first entry under Amazon Machine Images (AMIs).</p><p><img alt="Amazon Linux" loading=lazy src=/aws-codepipeline-for-static-websites/images/AmazonLinux.png></p><p>Click <strong>Select</strong>. On the next screen for instance type, choose <strong>t2.micro (free tier eligible)</strong>. Click <strong>Next - Configure Instance Details</strong>. Scroll down to <strong>Advanced</strong> and click to expand. Under User Data, paste the following code:</p><pre tabindex=0><code>#!/bin/bash
sudo yum update -y
sudo yum install -y httpd
sudo service httpd start
sudo chkconfig httpd on

sudo yum install ruby -y
sudo yum install wget -y
cd /home/ec2-user
wget https://aws-codedeploy-us-east-1.s3.amazonaws.com/latest/install
chmod +x ./install
sudo ./install auto
</code></pre><p>AWS provides User Data to allow us to pass one time commands to our server once it is provisioned, or booted up for the first time. The first part of the above code runs updates on the operating system, followed by installing and running our Apache web server. The second set of commands provisions our CodeDeploy agent, which we will be using later on for our Continuous Deployment. Click <strong>Next - Add Storage</strong> and leave all defaults as is. AWS automatically provisions an <strong>8Gb Elastic Block Storage (EBS) volume</strong> for our instance, which will act as our hard drive or storage. Click <strong>Next - Add Tags</strong> and add a Name tag for your instance. In my example I am using Name: <strong>carnaghan-dev</strong> as below.</p><p><img alt=tags loading=lazy src=/aws-codepipeline-for-static-websites/images/tags.png></p><p>Click <strong>Next - Configure Security Group</strong>. Here you will choose the security group you setup above. Be sure to complete this step correctly or you may not be able to access your instance.</p><p><img loading=lazy src=/aws-codepipeline-for-static-websites/images/assign-sg.png></p><p>After you have chosen your security group, click Review and Launch and on the following screen select Launch. You will be prompted to create or choose a key pair to access your server. Select the key pair you created above and then click launch instance.</p><p><img loading=lazy src=/aws-codepipeline-for-static-websites/images/select-key.png></p><p>At this stage you have completed all steps to launch your EC2 instance. It will take several minutes to provision and run our user data commands specified above. To view the status of your EC2 instance select <strong>View Instances</strong> on the confirmation page. After several minutes have passed, the status of your instance should change from Initializing to Running. At this time, copy the public DNS address, it should look something like ec2-99-99-999-99.compute-1.amazonaws.com. Paste this address into your web browser. If everything is running as expected with your new Apache webserver, you should see the test page below.</p><p><img loading=lazy src=/aws-codepipeline-for-static-websites/images/test-page.jpeg></p><p>If you don&rsquo;t see the test page, give your instance another few minutes to fully initialize.</p><h2 id=setting-up-code-commit>Setting up Code Commit<a hidden class=anchor aria-hidden=true href=#setting-up-code-commit>#</a></h2><p>There are two main ways you can manage CodeCommit repositories:</p><ul><li>Install the AWS Command Line Interface (CLI) and provide CodeCommit to your AWS account</li><li>Create a public SSH Key which you can then upload to your repository (in a similar way you would manage a Github repository)</li></ul><p>For this setup, I am going to recommend using the CLI as it provides a lot more options out of the box and the more you work with AWS the more you will come to use this tool. In order to install the CLI, follow this guide: Installing the AWS CLI. If you prefer to use a public key, see Setup for SSH Users Not Using the AWS CLI.</p><p>Next we will setup our code repository, which will enable us to update our website. Using the AWS console, head over to CodeCommit and create a new repository.</p><p><img alt=codecommit loading=lazy src=/aws-codepipeline-for-static-websites/images/codecommit-create.jpeg></p><p>I am again using the name carnaghan-dev for consistency. Once you have setup your repository you will need to clone a local copy. If you don&rsquo;t have a git client, please see the links I provided at the beginning of this article (Homebrew for Mac, GitSCM for PC). Once your client is setup and you have installed the AWS CLI or uploaded your public key, you should be able to clone your repository. In your command line / terminal, run the following command replacing &lsquo;your-repo-name&rsquo;:</p><pre tabindex=0><code>git clone https://git-codecommit.us-east-1.amazonaws.com/v1/repos/your-repo-name
</code></pre><p>Once cloned you will be able to begin adding new files. We are going to create two different files needed for our code deployment, a test index file, and a file called appspec.yml.</p><p>index.html</p><p>appspec.yml</p><p>Once you have added these files to your empty repository directory we will need to commit them.</p><pre tabindex=0><code>git add -A
git commit -m &#34;Initial commit&#34;
git push
</code></pre><p>Next, head back over to your repository in the AWS console to confirm your files have been uploaded.</p><p><img alt="gitcommit files" loading=lazy src=/aws-codepipeline-for-static-websites/images/gitcommit-files.jpeg></p><p>You have completed the first steps in our code pipeline by initializing your CodeCommit repository and adding our appspec.yml and index.html files.</p><h3 id=what-is-appspecyml>What is appspec.yml?<a hidden class=anchor aria-hidden=true href=#what-is-appspecyml>#</a></h3><p>You might be wondering what appspec.yml is needed for? This is a basic yaml file that defines where our code will be deployed. Since this is going to be a simple static file deployment, we just need to specify our server path, which by default with Apache is /var/www/html/. AWS CodeDeploy will use this file once deploying the latest updates to our site. For a better overview of appspec.yml, take a look at AWS CodeDeploy AppSpec File Reference.</p><h2 id=codedeploy>CodeDeploy<a hidden class=anchor aria-hidden=true href=#codedeploy>#</a></h2><p>Now that we have our code repository setup with our basic file structure, the next step is to setup our CodeDeploy application. To do this, navigate to CodeDeploy within the AWS console and select &lsquo;Create Application&rsquo;. Fill out the form including your application name and choose EC2/On-Premesis.</p><p><img alt=codedeploy loading=lazy src=/aws-codepipeline-for-static-websites/images/codedeploy.jpeg></p><p>Next, you will need to select &lsquo;Create Deployment Group&rsquo; and provide the following information:</p><ul><li>Deployment group name (I chose carnaghan-dev-group)</li><li>Service Role (Choose the service role you created earlier)</li><li>Deployment Type (In-place)</li><li>Environment configuration (EC2 Instance / Key: Name, Value: your-ec2-instance)</li><li>Deployment Settings (CodeDeployDefault.AllAtOnce)</li><li>Load Balancer (Uncheck this option)</li></ul><h2 id=codepipeline>CodePipeline<a hidden class=anchor aria-hidden=true href=#codepipeline>#</a></h2><p>Now that we have defined our source (CodeCommit) and our target (CodeDeploy), let&rsquo;s tie it all together using CodePipeline. Note that usually in larger applications that require build processes we would also use CodeBuild. For the sake of simplicity and since we are dealing with a small static website, we only need CodeCommit and CodeDeploy for our pipeline. From the AWS console, select CodePipeline and then select &lsquo;Create Pipeline&rsquo;. You will need to provide the following information:</p><ul><li>Pipeline Name (I am using the name carnaghan-pipeline)</li><li>Choose &lsquo;New Service Role&rsquo; and leave the new default role name (Note this is different from the CodeDeploy service role you created at the beginning of this article).</li><li>Make sure &lsquo;Allow AWS CodePipeline to create a service role so it can be used with this new pipeline&rsquo; is checked</li><li>Choose Default Location - AWS will create an S3 Bucket for your revisions to deploy</li><li>Select Next and then choose CodeCommit for Source Provider, choose your repository and select &lsquo;Master&rsquo; branch</li><li>Leave Amazon CloudWatch Events selected and select &lsquo;Next&rsquo;</li><li>Select Skip Build Stage</li><li>Choose AWS CodeDeploy for Deployment Provider and select your application and deployment group</li><li>Review everything and then select &lsquo;Create Pipeline&rsquo;</li></ul><p>Once you have completed these steps you should be returned to the main CodePipeline screen and a new deployment will run. If everything was setup correctly you should see a screen similar to the one below.</p><p><img alt="CodeDeploy Success" loading=lazy src=/aws-codepipeline-for-static-websites/images/code-deploy-success.jpeg></p><p>To verify everything worked as planned, visit your EC2 server homepage. If you forgot the URL, visit EC2 in the AWS Console, click &lsquo;Running Instances&rsquo; and select your instance to review the Public DNS address. You should now see a new HTML page displaying:</p><p><img alt="CodeDeploy Test" loading=lazy src=/aws-codepipeline-for-static-websites/images/codedeploytest.png></p><h2 id=testing-the-pipeline>Testing The Pipeline<a hidden class=anchor aria-hidden=true href=#testing-the-pipeline>#</a></h2><p>Congratulations, you have setup a basic CodePipeline for your webpage. Let&rsquo;s try one last thing. Update your HTML page by adding the sentence &lsquo;AWS CodePipeline complete&rsquo;.</p><p>Add this file to Git and push your changes.</p><pre tabindex=0><code>git add -A 
git commit -m &#34;Modifying index.html&#34; 
git push
</code></pre><p>If you visit the CodePipeline page you should see it momentarily running a new deployment. Your final changes will appear once deployment has been completed.</p><p><img alt="CodeDeploy Update" loading=lazy src=/aws-codepipeline-for-static-websites/images/code-deploy-update.png></p><p>For more information on CodePipeline and another tutorial on setting up a basic pipeline, visit Create a Simple Pipeline (AWS CodeCommit Repository). Also be sure to read the documentation on CodeCommit, CodeDeploy, and CodePipeline. If you have a more complex application that requires build processes, the AWS CodeBuild Documentation is a great place to start. Hopefully you found this helpful.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://www.carnaghan.com/tags/aws/>Aws</a></li></ul><nav class=paginav><a class=prev href=https://www.carnaghan.com/relational-vs-star-schema-model/><span class=title>« Prev</span><br><span>Relational vs Star Schema Model</span>
</a><a class=next href=https://www.carnaghan.com/javascript-arrays-properties-and-methods/><span class=title>Next »</span><br><span>JavaScript Arrays - Properties and Methods</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share AWS CodePipeline for Static Websites on x" href="https://x.com/intent/tweet/?text=AWS%20CodePipeline%20for%20Static%20Websites&amp;url=https%3a%2f%2fwww.carnaghan.com%2faws-codepipeline-for-static-websites%2f&amp;hashtags=aws"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share AWS CodePipeline for Static Websites on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.carnaghan.com%2faws-codepipeline-for-static-websites%2f&amp;title=AWS%20CodePipeline%20for%20Static%20Websites&amp;summary=AWS%20CodePipeline%20for%20Static%20Websites&amp;source=https%3a%2f%2fwww.carnaghan.com%2faws-codepipeline-for-static-websites%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share AWS CodePipeline for Static Websites on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fwww.carnaghan.com%2faws-codepipeline-for-static-websites%2f&title=AWS%20CodePipeline%20for%20Static%20Websites"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share AWS CodePipeline for Static Websites on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.carnaghan.com%2faws-codepipeline-for-static-websites%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share AWS CodePipeline for Static Websites on whatsapp" href="https://api.whatsapp.com/send?text=AWS%20CodePipeline%20for%20Static%20Websites%20-%20https%3a%2f%2fwww.carnaghan.com%2faws-codepipeline-for-static-websites%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share AWS CodePipeline for Static Websites on telegram" href="https://telegram.me/share/url?text=AWS%20CodePipeline%20for%20Static%20Websites&amp;url=https%3a%2f%2fwww.carnaghan.com%2faws-codepipeline-for-static-websites%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share AWS CodePipeline for Static Websites on ycombinator" href="https://news.ycombinator.com/submitlink?t=AWS%20CodePipeline%20for%20Static%20Websites&u=https%3a%2f%2fwww.carnaghan.com%2faws-codepipeline-for-static-websites%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://www.carnaghan.com/>Ian Carnaghan</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>